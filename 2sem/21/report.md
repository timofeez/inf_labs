# Отчет по лабораторной работе № 21
## по курсу "Фундаментальная информатика"

Студент группы М8О-108Б-23 Григорьев Тимофей Андреевич

Работа выполнена 

Преподаватель: каф. 806 Севастьянов Виктор Сергеевич

1. **Тема**: программирование на интерпретируемых командных языках
2. **Цель работы**: составить программу для разделения файла на части фиксированного размера на Bash
3. **Задание (вариант №5)**: реализовать шелловскую версию команды split на Bash, с учетом заданного пользователем количества строк в каждом выходном файле
4. **Идея, метод, алгоритм решения задачи**:
   - Для разделения файла на части использовалась команда `read` вместе с циклом `while` для чтения исходного файла построчно.
   - С помощью переменных окружения и арифметических операций в Bash организован подсчет строк и создание новых файлов с заданным количеством строк.
   - Использование функции `next_suffix` для генерации алфавитного суффикса для новых файлов.
5. **Сценарий выполнения работы**:
   - Определение и проверка входных аргументов скрипта: путь к исходному файлу, количество строк на файл, префикс выходных файлов.
   - Создание цикла `while`, который считывает строки из файла, и запись их в новый файл до достижения заданного количества строк.
   - После записи заданного количества строк, генерация нового имени файла с помощью функции `next_suffix` и продолжение процесса разделения.
   - Вывод сообщения о завершении процесса разделения файла.
6. **Протокол**:

```bash
#!/bin/bash

FILENAME=$1
LINES_PER_FILE=$2
PREFIX=$3

if [[ -z "$FILENAME" || -z "$LINES_PER_FILE" ]]; then
    echo "Usage: $0 <file_to_split> <lines_per_file> [output_file_prefix]"
    exit 1
fi

if [[ ! -f "$FILENAME" ]]; then
    echo "Error: File '$FILENAME' not found!"
    exit 1
fi

if [[ -z "$PREFIX" ]]; then
    PREFIX='x'
fi

next_suffix() {
    echo $(printf "%02d" $1 | tr '0-9' 'a-z')
}

COUNTER=0
LINE_COUNT=0
SUFFIX=$(next_suffix $COUNTER)

while IFS= read -r line; do
    OUTPUT_FILE="${PREFIX}${SUFFIX}"
    echo "$line" >> "$OUTPUT_FILE"
    ((LINE_COUNT++))
    if [ "$LINE_COUNT" -eq "$LINES_PER_FILE" ]; then
        LINE_COUNT=0
        ((COUNTER++))
        SUFFIX=$(next_suffix $COUNTER)
    fi
done < "$FILENAME"

echo "File '$FILENAME' has been split into multiple files with prefix '$PREFIX'"
```

7. **Замечания автора**: нет
8. **Выводы**: В ходе выполнения лабораторной работы я научился создавать скрипты на Bash, которые могут работать с файлами и выполнять сложные задачи, такие как разделение файла на части. Я понял, как использовать циклы, чтение файлов и обработку строк в Bash, а также как работать с пользовательским вводом и аргументами командной строки. Полученные знания и навыки будут полезны для автоматизации задач обработки текстовых данных и управления файлами в Unix-подобных операционных системах.